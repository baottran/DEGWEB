<style>
.c3-axis-x{
	stroke-width: 1px;
}

.c3-line {
	fill: none;
}


</style>
<div class="panel panel-default">
  	<div class="panel-heading">IP</div>
  	<div class="panel-body">
  		<div class="chart-edit-buttons">
  			<a href="#" class="btn btn-info" id="All">All</a>
  			<a href="#" class="btn btn-info" id="Week">Week</a>
  			<a href="#" class="btn btn-info" id="Month">Month</a>
  			<a href="#" class="btn btn-info" id="Quarter">Quarter</a>
  			<a href="#" class="btn btn-info" id="Year">Year</a>
  		</div>
  		<br>
  		  <div id="chart"></div>
  		  <br>
  		  <div class="stats">
  		  	<div class="database">
  		  		<h4>Audatex</h4>
  		  		<div class="content">
              <div class="right-content">
                  <br>
                  <br>
                  <br><%= percent_submitted("Audatex") %> % 
                  <br>
              </div>
              <div class="left-content">
                  Not Submitted
                  <br><%= num_unsubmitted("Audatex")%>
                  <br>Submitted
                  <br><%= num_submitted("Audatex") %>
                  <br>Total
                  <br><%= total("Audatex") %>
              </div>
  		  		</div>

  		  	</div>
  		  	<div class="database">
  		  		<h4>CCC</h4>
  		  		<div class="content">
              <div class="right-content">
                  <%= num_submitted("CCC") %> 
                  <br>of
                  <br><%= Inquiry.where(database: "CCC").count %>
                  <br>
                  <br><%= percent_submitted("CCC") %> % 
              </div>
              <div class="left-content">
                  Not Submitted
                  <br><%= num_unsubmitted("CCC")%>
                  <br>Submitted
                  <br><%= num_submitted("CCC") %>
                  <br>Total
                  <br><%= total("CCC") %>
              </div>
  		  		</div>
  		  	</div>
  		  	<div class="database">
  		  		<h4>Mitchell</h4>
  		  		<div class="content">
	  		  		<div class="right-content">
	  		  				<%= num_submitted("Mitchell") %> 
	  		  				<br>of
                  <br><%= Inquiry.where(database: "Mitchell").count %>
                  <br>
	  		  				<br><%= percent_submitted("Mitchell") %> % 
	  		  		</div>
	  		  		<div class="left-content">
	  		  				Not Submitted
	  		  				<br><%= num_unsubmitted("Mitchell")%>
	  		  				<br>Submitted
	  		  				<br><%= num_submitted("Mitchell") %>
	  		  				<br>Total
	  		  				<br><%= total("Mitchell") %>
	  		  		</div>
  		  		</div>
  		  	</div>
  		  </div>
  	</div>
  </div>



<script>

<% new_inquiries_test %>

var formatter;

function updateFormatter(byMonth) {
  formatter = d3.time.format(byMonth ? '%Y-%m' : '%Y-%m-%d')
  // formatter = d3.time.format('%Y-%m-%d')

}

updateFormatter(false);


  // var chart = c3.generate({
  //     bindto: '#chart',
  //   data: {
  //     x: 'x',
  //     columns: <%=raw new_inquiries_all %>
  // },
  // axis: {
  //     x: {
  //         type: "timeseries",
  //         format: function(x){
  //           return formatter(x)
  //         }
  //     }
  // }
  // });

var chart = c3.generate({
    bindto: '#chart',
    data: {
      x: 'x',
      columns: <%=raw new_inquiries_all %>
    },
    axis: {
      x: {
        type: 'timeseries',
        tick: {
            format: function (x) { // x comes in as a time string.
              return formatter(x);
            }
        }
      }
    }
});

    $("#All").click(function(event) {
      event.preventDefault();
            chart.load({
      columns: <%=raw new_inquiries_all %>,
      unload: ['x', 'Audatex', 'Mitchell', 'CCC']
  });
    
    });

    $("#Week").click(function(event) {
      event.preventDefault();
      updateFormatter(false);
      chart.load({
        columns: <%=raw new_inquiries_week %>,
        unload: ['x', 'Audatex', 'Mitchell', 'CCC']
      });
    
    });

    $("#Month").click(function(event) {
      event.preventDefault();
            chart.load({
      columns: <%=raw new_inquiries_month %>,
      unload: ['x', 'Audatex', 'Mitchell', 'CCC']
  });
    
    });

        $("#Quarter").click(function(event) {
      event.preventDefault();
            chart.load({
      columns: <%=raw new_inquiries_quarter %>,
      unload: ['x', 'Audatex', 'Mitchell', 'CCC']
  });
    
    });

            $("#Year").click(function(event) {
      event.preventDefault();
            chart.load({
      columns: <%=raw new_inquiries_year %>,
      unload: ['x', 'Audatex', 'Mitchell', 'CCC']
  });
    
    });


</script>

  <br>
  <div class="panel panel-default">
  	<div class="panel-heading">Not Submitted Inquiries (<%= @inquiries.count %>)</div>
  	<div class="panel-body">
	  	<a href="/reporting" class="btn btn-info">All</a>
			<a href="/reporting?database=Autodex" class="btn btn-info">Autodex</a>
			<a href="/reporting?database=CCC" class="btn btn-info">CCC</a>
			<a href="/reporting?database=Mitchell" class="btn btn-info">Mitchell</a>
			<br><br>
		  <% if @inquiries.count != 0 %>
      <%= will_paginate @inquiries %>
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th><%= sortable 'id', "#", params[:status] %></th>
            <th><%= sortable 'database', 'Estimating Platform', params[:status] %></th>
            <th><%= sortable 'inquiry_type', 'Inquiry Type', params[:status] %></th>
            <th><%= sortable 'year', 'Vehicle', params[:status] %></th>
            <th>Inquiry Description</th>
            <th><%= sortable 'status', 'Status', params[:status] %></th>
            <th>Resolution</th>
            <th><%= sortable 'created_at', 'Origination Date', params[:status] %></th>
            <th><%= sortable 'submit_to_ip_date', 'Submission Date', params[:status] %></th>
            <th><%= sortable 'resolution_date', 'Resolution Date', params[:status] %></th>
            <th>Total Time To Resolve</th>
          </tr>
        </thead>
        <tbody>

        <% @inquiries.each do |inquiry| %>
          <tr>
            <td><%= link_to inquiry.id, inquiry_path(inquiry) %></td>
            <td><%= inquiry.database %></td>
            <td><%= inquiry.inquiry_type %></td>
            <td><%= inquiry.year %> <%= inquiry.make %> <%= inquiry.model %></td>
            <td><img class="icon icons8-Search-Filled" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAA0klEQVQoU62SjQ0BURCEv6uADlABOqACSqADKqAEHaADJdDBdUAJVEBGdi/vbZzchU1e7uftTGZmt+CHKgJ2AmwAPVV34ASs7T1rT8ELYA8cgYM194Et0AHGkcDBaroCSwNGM2fgCUzTCwfvgFEiN4KdfADc/NLBYtaRxLqSf1lTBu/6C1iyh9FTIuGr7CaByatkV/VpVBqTzgPoWQ4KszRl8p559m8txwqY2Q8RyNLcbGUEccPqku7aNJRLRdAULNKU4KKdaAN2As1Z1sq24MzWC9IUMRAfAtjoAAAAAElFTkSuQmCC" width="15" height="15" title="<%= inquiry.description_tooltip %>"> <%= inquiry.area_of_vehicle %></td>
            <td><%= inquiry.status %></td>
            <td><% if inquiry.resolution != nil %>
                  <img class="icon icons8-Search-Filled" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAA0klEQVQoU62SjQ0BURCEv6uADlABOqACSqADKqAEHaADJdDBdUAJVEBGdi/vbZzchU1e7uftTGZmt+CHKgJ2AmwAPVV34ASs7T1rT8ELYA8cgYM194Et0AHGkcDBaroCSwNGM2fgCUzTCwfvgFEiN4KdfADc/NLBYtaRxLqSf1lTBu/6C1iyh9FTIuGr7CaByatkV/VpVBqTzgPoWQ4KszRl8p559m8txwqY2Q8RyNLcbGUEccPqku7aNJRLRdAULNKU4KKdaAN2As1Z1sq24MzWC9IUMRAfAtjoAAAAAElFTkSuQmCC" width="15" height="15" title="<%= inquiry.resolution%>">
                <% end %>
            </td>
            <td><%= inquiry.created_at.strftime("%-m/%-d/%y") %></td>
            <td><% if inquiry.submit_to_ip_date != nil %>
                  <%= inquiry.submit_to_ip_date.strftime("%-m/%-d/%y") %>
                <% end %></td>
            <td><% if inquiry.resolution_date != nil %>
                  <%= inquiry.resolution_date.strftime("%-m/%-d/%y") %>
                <% end %></td>
            <td><%= inquiry.time_to_resolve_days %></td>
          
          </tr>
        <% end %>

        </tbody>
      </table>
      <% else %>
        <p>0 records match your search. Please try again.</p>
      <% end %>
    </div>
    <%= will_paginate @inquiries %>
  	</div>